---
import Layout from "@/layouts/main.astro";
import trpc from "@/trpc/client";
import { ArrowLeft } from "lucide-react";
import { format } from "date-fns";

export async function getStaticPaths() {
  const posts = await trpc.posts.findAllPublished.query();

  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
---

<Layout title={post.title}>
  <main
    class="flex flex-1 flex-col items-center justify-start py-2"
    transition:animate="slide"
  >
    <section
      class="flex w-3/6 flex-col items-start justify-center gap-8 pt-2 text-start max-md:w-5/6"
    >
      <a
        href="/blog"
        class="hover:text-primary flex items-center justify-center gap-1 text-base opacity-60 hover:underline"
      >
        <ArrowLeft size={16} />
        <span> Back to posts </span>
      </a>

      <div class="flex flex-col items-center justify-center gap-10">
        <div class="flex w-full flex-col gap-2">
          <h1 class="text-5xl font-bold">{post.title}</h1>
          <p class="opacity-40">
            {post.publishDate && format(post.publishDate, "MMM dd, yyyy")}
          </p>
        </div>

        <article class="w-full text-[18px] opacity-75">
          {post.content}
        </article>
      </div>
    </section>
  </main>
</Layout>
